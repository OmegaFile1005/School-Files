<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.css">
  <!-- <link rel="stylesheet" href="jssissuemanager.css"> -->
  <script defer src="jsissuemanager.js"></script>
</head>

<body>
  <div class="container">
    <div class="row">
      <div class="col text-center mb-3">
        <img src="checklist.png" id="img" alt="checklist">
      </div>
    </div>
    <div class="row">
      <div class="col text-end mb-3">
        <p>Welcome: <span id="activeUser" style="font-style: italic;"></span></p>
        <p id="logout" class="text text-primary" onclick="logOut()">Logout</p>
      </div>
    </div>
    <div class="row bg-secondary-subtle  rounded p-3">
      <div class="col">
        <form>
          <div class="col-md-11 pt-3">
            <h2>Add New Issue:</h2>
            <label for="issueDescription">Description</label><br>
            <input list="issueDescriptions" type="text" id="issueDescription" class="form-control mb-3" placeholder="Describe the issue ..."><br>
            <datalist id="issueDescriptions">
            </datalist>
            <label for="severity">Severity</label><br>
            <select id="severity" class="form-select mb-3" aria-label="Severity">
              <option value="Low" selected>Low</option>
              <option value="Medium">Medium</option>
              <option value="High">High</option>
            </select><br>
            <label for="assignedTo">Assigned To</label><br>
            <input list="assignedUsers" type="text" id="assignedTo" class="form-control mb-3" placeholder="Enter responsible ..."><br>
            <datalist id="assignedUsers">
            </datalist>
          </div>
          <div class="col">
            <button type="button" class="btn btn-primary" onclick="addIssue()">Add</button>
          </div>
        </form>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col">
        <div id="issues">
        </div>
      </div>
    </div>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      let issueDescriptions = document.getElementById('issueDescriptions');
      let assignedUsers = document.getElementById('assignedUsers');
      let users = JSON.parse(localStorage.getItem('users'));
      if (users) {
        users.forEach(user => {
          let issueDescriptionOption = document.createElement('option');
          issueDescriptionOption.value = user.username;
          issueDescriptionOption.textContent = user.username;
          issueDescriptions.appendChild(issueDescriptionOption);
          let assignedUserOption = document.createElement('option');
          assignedUserOption.value = user.username;
          assignedUserOption.textContent = user.username;
          assignedUsers.appendChild(assignedUserOption);
        });
      }
    });
    window.onload = function () {
      displayIssues();
      const activeUser = document.getElementById('activeUser');
      const user = JSON.parse(localStorage.getItem('Active User'));
      activeUser.textContent = user && user.fullName ? user.fullName : 'Guest';
    }
  </script>
</body>

</html>